alloy:
  configMap:
    content: |-
      local.file_match "match_logs" {
        path_targets = [{"__path__" = "/var/log/*.log"}]
        sync_period  = "5s"
      }

      loki.source.file "collect_logs" {
        targets       = local.file_match.match_logs.targets
        forward_to    = [loki.write.send_logs.receiver]
        tail_from_end = true
      }

      loki.write "send_logs" {
        endpoint {
          url = "http://grafana-loki.grafana-loki.svc.cluster.local:3100/loki/api/v1/push"
        }
      }

  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 300m
      memory: 640Mi
